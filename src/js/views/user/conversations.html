<div class="row">

  <div class="z-depth-1 offset-s1 chatBoxBounding">

    <div class="col s3" id="chatList">
      <div class="chatHeading">
        <img ng-src="{{ main.currentUser.image_src }}" alt="profile.user.image" class="NavProfileImage">
      </div>

      <div ng-repeat="conversation in conversations.conversations track by $index">

        <div class="col s12 chatSidebarMessages">
          <div ng-click="conversations.selectConversation(conversation, $index)" class="cursor">

            <div class="row">
              <div class="col s2 marginRightSm">
                <img ng-src="{{ conversation.receiver.image }}" alt="profile.user.imageSRC" class=" chatProfileImage">
              </div>
              <div class="col s9">


                <h4> {{conversation.receiver.username }}</h4>
                <div ng-repeat="message in conversation.messages track by $index">
                  <div ng-if="(conversation.messages.length-1) === $index">
                    <p> {{ message.body | limitTo: 50 }}... </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <p ng-show="conversations.index === null"> Please select a conversation </p>

    <!-- CONVERSATION -->
    <!-- {{ conversations.conversations[conversations.index].messages[0] }} -->
    <div ng-show="conversations.index !== null" class="col s9 blue">
      <div ng-repeat="message in conversations.conversations[conversations.index].messages">
        <div class="row marginZero">
          <div ng-class="{true:'speech-bubble-sent', false:'speech-bubble-received'}[main.currentUser.id === message.user_id]">
            <p> {{ message.body }} </p> <small>{{ message.updated_at | date : 'shortTime' }}</small></div>
          </div>
        </div>

        <!-- WRITE A MESSAGE SECTION -->
        <form ng-show="conversations.index !== null" ng-submit="conversations.addMessage(conversations.message)" name="conversations.messageForm">
          <div class="col s8 chatInput">
            <label for="body">Write a message... </label>
            <input type="text" ng-model="conversations.message.body" name="body" id="body" required>
            <button>Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>
